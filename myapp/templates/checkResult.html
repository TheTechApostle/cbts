{% load static %}
{% include 'header.html' %}

<style>
  .report-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    padding: 30px;
    margin-top: 40px;
  }

  .school-header {
    text-align: center;
    border-bottom: 3px solid #0d6efd;
    padding-bottom: 15px;
    margin-bottom: 25px;
  }

  .school-header img {
    height: 80px;
    margin-bottom: 10px;
  }

  .school-header h3 {
    margin: 0;
    font-weight: 700;
    color: #0d6efd;
  }

  .school-header p {
    margin: 0;
    color: #555;
    font-size: 14px;
  }

  .student-info {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 25px;
  }

  .student-info h5 {
    margin-bottom: 5px;
    font-weight: 600;
    color: #333;
  }

  .student-info small {
    color: #777;
  }

  table th {
    background-color: #0d6efd !important;
    color: white !important;
    text-align: center;
  }

  table td {
    text-align: center;
    vertical-align: middle;
  }

  .footer-note {
    margin-top: 40px;
    text-align: center;
    color: #555;
    font-size: 14px;
  }

  .signature {
    margin-top: 30px;
    display: flex;
    justify-content: space-between;
    padding: 0 30px;
  }

  .signature div {
    text-align: center;
    border-top: 1px solid #333;
    width: 200px;
    padding-top: 5px;
  }

  .print-btn {
    text-align: right;
    margin-top: 20px;
  }

  /* âœ… Print styles â€” only print the report card */
  @media print {
    body * {
      visibility: hidden;
    }

    #reportCard, #reportCard * {
      visibility: visible;
    }

    #reportCard {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      background: white;
    }

    .print-btn {
      display: none !important;
    }
  }
body {
    background: url("{% static 'img/wha.jpg' %}") no-repeat center center fixed;
    background-size: cover;
    min-height: 100vh;
    font-family: 'Poppins', sans-serif;
}
</style>

<div class="container py-5">

  <!-- âœ… Result Check Form -->
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white text-center">
          <h4 class="mb-0">Student Result Checker</h4>
        </div>
        <div class="card-body">
          <form method="POST">
            {% csrf_token %}
            <div class="mb-3">
              <label class="form-label">Admission Number</label>
              {{ form.admission_number }}
            </div>
            <div class="mb-3">
              <label class="form-label">Access Code</label>
              {{ form.access_code }}
            </div>
            <button type="submit" class="btn btn-primary w-100">Check Result</button>
          </form>

          {% if error %}
            <div class="alert alert-danger mt-3">{{ error }}</div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… Report Card Section -->
  {% if student and results %}
  <div class="report-card mt-5" id="reportCard">

    <!-- School Header -->
    <div class="school-header">
      {% if getLogo %}
        <img src="{{ getLogo.LogoImage.url }}" alt="School Logo">
      {% endif %}
      <h3>{{ getTitle.name|default:"SCHOOL NAME" }}</h3>
      <p>{{ getTitle.address|default:"School Address" }}</p>
      <p>
        <strong>Tel:</strong> {{ getTitle.phoneNo|default:"+234 7067071427" }} |
        <strong>Email:</strong> {{ getTitle.email|default:"info@school.com" }}
      </p>
    </div>

    <!-- Student Info -->
    <div class="student-info">
      <div class="row">
        <div class="col-md-6">
          <h5>Student: {{ student.full_name }}</h5>
          <small>Admission Number: {{ student.admission_number }}</small>
        </div>
        <div class="col-md-6 text-md-end">
          <h5>Class: {{ student.level_or_class.name }}</h5>
          <small>Department: {{ student.department.name }}</small>
        </div>
      </div>
    </div>

    <!-- Results Table -->
    <div class="table-responsive">
      <table class="table table-bordered align-middle">
        <thead>
          <tr>
            <th>Exam</th>
            <th>Course</th>
            <th>Exam Score</th>
            <th>Test Score</th>
            <th>Percentage</th>
            <th>Grade</th>
          </tr>
        </thead>
        <tbody>
          {% for exam in results %}
          <tr>
            <td>{{ exam.exam.title }}</td>
            <td>{{ exam.course.title }}</td>
            <td></td>
            <td>{{ exam.total_score }}</td>
            <td>{{ exam.percentage }}%</td>
            <td></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Signature Section -->
    <div class="signature">
      <div>Class Teacher</div>
      <div>Principal</div>
    </div>

    <!-- Footer Note -->
    <div class="footer-note">
      <p>Â© {{ getTitle.name|default:"SCHOOL NAME" }} â€” Powered by 
        <a href="https://heroesgroupofschools.com" target="_blank">
          Heroes Group of Schools
        </a>
      </p>
    </div>

    <!-- âœ… Print Button -->
    <div class="print-btn">
      <button class="btn btn-outline-primary" type="button" onclick="window.print()">
        ðŸ–¨ Print Report Card
      </button>
    </div>
  </div>
  {% endif %}
</div>

{% include 'footer.html' %}
